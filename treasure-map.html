<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Gavinbot's 3D Futuristic Mystical Treasure Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Orbitron for a futuristic font -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      background: linear-gradient(135deg, #202d37 0%, #0a2027 100%);
      color: #ffe14b;
      font-family: 'Orbitron', 'Trebuchet MS', Arial, sans-serif;
      min-height: 100vh;
      overflow-x: hidden;
    }
    h1 {
      text-align: center;
      font-size: 2.8em;
      color: #ffe14b;
      text-shadow: 0 0 22px #0ff, 0 0 44px #ffe14b;
      letter-spacing: 2px;
      margin: 1.2em 0 0.3em 0;
    }
    .instructions {
      text-align: center;
      font-size: 1.22em;
      color: #fff;
      margin: 0.7em auto 1.3em auto;
      max-width: 700px;
      background: rgba(40,40,70,0.38);
      border-radius: 16px;
      padding: 1em 1.4em;
      box-shadow: 0 0 14px #0ff44;
      font-family: 'Trebuchet MS', Arial, sans-serif;
    }
    .map-container {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 2em 0 0 0;
      position: relative;
    }
    #map3d {
      display: block;
      border-radius: 28px;
      border: 6px solid #ffe14b;
      box-shadow: 0 0 44px #0ff, 0 0 44px #ffe14b;
      background: #1b2126;
      width: 920px;
      max-width: 98vw;
      height: 580px;
      margin: auto;
      cursor: pointer;
    }
    #popup {
      position: absolute;
      background: rgba(20,30,60,0.95);
      color: #ffe14b;
      border: 2px solid #0ff;
      border-radius: 14px;
      padding: 1em 1.3em;
      font-size: 1.14em;
      max-width: 340px;
      box-shadow: 0 0 14px #0ff, 0 0 24px #ffe14b;
      display: none;
      z-index: 99;
      pointer-events: none;
      font-family: 'Trebuchet MS', Arial, sans-serif;
      backdrop-filter: blur(4px);
    }
    .legend {
      margin: 2.5em auto 1em auto;
      text-align: center;
      font-size: 1.15em;
      color: #fff;
      background: rgba(32,40,65,0.29);
      border-radius: 14px;
      display: inline-block;
      padding: 0.9em 2em;
      box-shadow: 0 0 10px #ffe14b44;
      font-family: 'Trebuchet MS', Arial, sans-serif;
      letter-spacing: 1px;
    }
    .legend span {
      margin: 0 1.5em;
    }
    .legend .icon {
      font-size: 1.5em;
      margin-right: 0.3em;
      vertical-align: middle;
    }
    .btn {
      background: linear-gradient(90deg,#19f7d2 40%,#ffe14b 100%);
      color: #1e2f3a;
      font-weight: bold;
      border: none;
      border-radius: 11px;
      padding: 0.7em 2em;
      font-size: 1.11em;
      box-shadow: 0 0 14px #19f7d2, 0 0 22px #ffe14b;
      cursor: pointer;
      transition: background .18s;
      margin: 2em auto 2em auto;
      display: block;
      font-family: 'Orbitron', Arial, sans-serif;
      letter-spacing: 1px;
    }
    .btn:active { background: linear-gradient(90deg,#ffe14b 30%,#19f7d2 100%);}
    footer {
      text-align:center;
      color:#ccc;
      margin:2.2em 0 1em 0;
      font-size: .99em;
      opacity:0.7;
      letter-spacing:1px;
      font-family: 'Trebuchet MS', Arial, sans-serif;
    }
    @media (max-width:950px) {
      #map3d { width:99vw; height:60vw; min-height:280px;}
    }
    @media (max-width:600px) {
      #map3d { min-height:180px;}
      .legend { font-size:1em; padding:0.7em 0.5em;}
      .instructions { font-size:1em; padding:0.7em 0.3em;}
    }
  </style>
</head>
<body>
  <h1>Mystical Futuristic Treasure Map 🗺️✨</h1>
  <div class="instructions">
    Click the glowing 3D locations to reveal secrets, clues, or magical events.<br>
    <b>Discover:</b> Hidden pirate ships, enchanted castles, floating islands, portals, and cosmic treasures.<br>
    <b>Unlock:</b> Riddles, mini-games, and mystical powers as you explore.<br>
    <b>Tip:</b> Some treasures only appear after solving other mysteries!
  </div>
  <div class="map-container" id="mapContainer">
    <canvas id="map3d" width="920" height="580"></canvas>
    <div id="popup"></div>
  </div>
  <div class="legend">
    <span><span class="icon">🌊</span>Sea</span>
    <span><span class="icon">🏴‍☠️</span>Pirate Ship</span>
    <span><span class="icon">🏰</span>Castle</span>
    <span><span class="icon">🏝️</span>Floating Island</span>
    <span><span class="icon">🌲</span>Enchanted Forest</span>
    <span><span class="icon">🔮</span>Portal</span>
    <span><span class="icon">💎</span>Treasure</span>
    <span><span class="icon">🦜</span>Parrot's Perch</span>
  </div>
  <button class="btn" onclick="resetMap()">Reset Map & Mysteries</button>
  <footer>
    &copy; 2025 Gavinbot Village | The treasure's not the gold; it's the mystery!
  </footer>
  <script>
    // --- Mystical Map Data ---
    const locations = [
      {
        name: "Pirate Ship",
        x: 170, y: 390, r: 36,
        icon: "🏴‍☠️",
        color: "#2ee0ff",
        clue: "⚓ The captain's ship floats above the glowing waves. Solve the code to board.",
        riddle: "Enter the secret pirate word (hint: starts with 'A'):",
        answer: "ahoy",
        event: "ship"
      },
      {
        name: "Enchanted Castle",
        x: 440, y: 140, r: 40,
        icon: "🏰",
        color: "#ffe14b",
        clue: "🏰 The castle towers shimmer with ancient magic. Only those with the ship's key may enter.",
        requires: "ship",
        event: "castle"
      },
      {
        name: "Floating Island",
        x: 710, y: 420, r: 34,
        icon: "🏝️",
        color: "#39ff14",
        clue: "🌴 This mystical island holds a cosmic crystal. Find the castle's magic first.",
        requires: "castle",
        event: "island"
      },
      {
        name: "Enchanted Forest",
        x: 700, y: 200, r: 32,
        icon: "🌲",
        color: "#8dffb3",
        clue: "🌲 The forest whispers riddles only the parrot understands.",
        event: "forest"
      },
      {
        name: "Parrot's Perch",
        x: 270, y: 90, r: 28,
        icon: "🦜",
        color: "#ff3c9b",
        clue: "🦜 Gavinbot's AI Parrot awaits with a clue for the portal.",
        event: "parrot"
      },
      {
        name: "Portal",
        x: 860, y: 60, r: 34,
        icon: "🔮",
        color: "#a0b9ff",
        clue: "🔮 The glowing portal needs the parrot's password to open a new world.",
        requires: "parrot",
        event: "portal"
      },
      {
        name: "Cosmic Treasure",
        x: 510, y: 500, r: 35,
        icon: "💎",
        color: "#fff",
        clue: "💎 The legendary cosmic treasure! Only those who solved all mysteries may claim.",
        requires: "island",
        event: "treasure"
      }
    ];

    // --- Inventory (Mystical Progress) ---
    let inventory = {};
    let solved = {};

    // --- Draw the 3D Futuristic Map ---
    const canvas = document.getElementById('map3d');
    const ctx = canvas.getContext('2d');
    function drawMap() {
      // Background
      ctx.clearRect(0,0,canvas.width,canvas.height);

      // Sea - 3D gradient effect
      let seaGrad = ctx.createLinearGradient(0,canvas.height/2,canvas.width,canvas.height);
      seaGrad.addColorStop(0, "#0d2a4a");
      seaGrad.addColorStop(0.45, "#2ee0ff");
      seaGrad.addColorStop(0.7, "#1a8a8a");
      seaGrad.addColorStop(1, "#0a2027");
      ctx.fillStyle = seaGrad;
      ctx.fillRect(0,canvas.height/2,canvas.width,canvas.height/2);

      // "Waves" - shadowed, for 3D effect
      for(let i=0;i<7;i++) {
        ctx.beginPath();
        ctx.moveTo(0, canvas.height/2 + 40 + i*24);
        ctx.bezierCurveTo(140+50*i, canvas.height/2+32+i*24, 500-40*i,canvas.height/2+66+i*24,canvas.width, canvas.height/2+56+i*24);
        ctx.strokeStyle = "rgba(30,220,255,"+(0.11+0.07*i)+")";
        ctx.lineWidth = 8;
        ctx.stroke();
      }

      // Islands - blurred, glowing
      ctx.save();
      ctx.shadowColor = "#39ff14";
      ctx.shadowBlur = 22;
      ctx.beginPath();
      ctx.ellipse(730,430,60,38,Math.PI/9,0,2*Math.PI);
      ctx.fillStyle = "#222d";
      ctx.fill();
      ctx.restore();

      // Forest - glowing, 3D
      ctx.save();
      ctx.shadowColor = "#8dffb3";
      ctx.shadowBlur = 14;
      ctx.beginPath();
      ctx.arc(700,200,52,0,2*Math.PI);
      ctx.fillStyle="#1a4e2a";
      ctx.fill();
      ctx.restore();

      // Castle hill - 3D
      ctx.save();
      ctx.shadowColor = "#ffe14b";
      ctx.shadowBlur = 14;
      ctx.beginPath();
      ctx.ellipse(440,160,54,30,Math.PI/8,0,2*Math.PI);
      ctx.fillStyle = "#4b2e21";
      ctx.fill();
      ctx.restore();

      // Ship shadow
      ctx.save();
      ctx.shadowColor = "#2ee0ff";
      ctx.shadowBlur = 12;
      ctx.beginPath();
      ctx.ellipse(170,410,46,16,Math.PI/7,0,2*Math.PI);
      ctx.fillStyle = "#232323";
      ctx.globalAlpha=0.3;
      ctx.fill();
      ctx.restore();
      ctx.globalAlpha=1;

      // Portal - mystic glow
      ctx.save();
      ctx.shadowColor = "#a0b9ff";
      ctx.shadowBlur = 22;
      ctx.beginPath();
      ctx.arc(860,60,38,0,2*Math.PI);
      ctx.fillStyle="#a0b9ff";
      ctx.globalAlpha=0.22;
      ctx.fill();
      ctx.restore();
      ctx.globalAlpha=1;

      // Treasure glow
      ctx.save();
      ctx.shadowColor = "#fff";
      ctx.shadowBlur = 26;
      ctx.beginPath();
      ctx.ellipse(510,510,33,18,Math.PI/8,0,2*Math.PI);
      ctx.fillStyle = "#fff";
      ctx.globalAlpha=0.18;
      ctx.fill();
      ctx.restore();
      ctx.globalAlpha=1;

      // Draw 3D highlights on locations
      locations.forEach(loc=>{
        ctx.save();
        ctx.shadowColor = loc.color;
        ctx.shadowBlur = 26;
        ctx.beginPath();
        ctx.arc(loc.x,loc.y,loc.r,0,2*Math.PI);
        ctx.fillStyle = "#222";
        ctx.globalAlpha=0.92;
        ctx.fill();
        ctx.restore();

        // Draw icon "floating" above
        ctx.font = "3em serif";
        ctx.textAlign = 'center';
        ctx.globalAlpha=1;
        ctx.fillText(loc.icon,loc.x,loc.y+8);

        // If solved, show an aura
        if (inventory[loc.event]) {
          ctx.save();
          ctx.beginPath();
          ctx.arc(loc.x,loc.y,loc.r+14,0,2*Math.PI);
          ctx.strokeStyle = "#ffe14b";
          ctx.shadowColor = "#0ff";
          ctx.shadowBlur = 22;
          ctx.lineWidth = 6;
          ctx.globalAlpha=0.55;
          ctx.stroke();
          ctx.restore();
        }
      });

      // Draw mystical lines between solved locations
      ctx.save();
      ctx.globalAlpha=0.20;
      ctx.strokeStyle="#0ff";
      ctx.lineWidth=7;
      let last = null;
      locations.forEach(loc=>{
        if (inventory[loc.event]) {
          if (last) {
            ctx.beginPath();
            ctx.moveTo(last.x,last.y);
            ctx.lineTo(loc.x,loc.y);
            ctx.stroke();
          }
          last = loc;
        }
      });
      ctx.restore();
    }
    drawMap();

    // --- Popup logic ---
    const popup = document.getElementById('popup');
    function showPopup(html,x,y) {
      popup.innerHTML = html;
      popup.style.left = (x+30)+"px";
      popup.style.top = (y-20)+"px";
      popup.style.display = "block";
      setTimeout(()=>popup.style.display="none", 6000);
    }

    // --- Click events ---
    canvas.addEventListener('click', function(e){
      const rect = canvas.getBoundingClientRect();
      const mouseX = e.clientX - rect.left;
      const mouseY = e.clientY - rect.top;
      let found = false;
      locations.forEach(loc=>{
        let dx = mouseX - loc.x;
        let dy = mouseY - loc.y;
        if (dx*dx + dy*dy < loc.r*loc.r + 18*18) {
          found = true;
          let html = `<b style="font-size:1.2em;">${loc.icon} ${loc.name}</b><br>`;
          html += `<span>${loc.clue}</span><br>`;
          // Check unlock requirements
          if (loc.requires && !inventory[loc.requires]) {
            html += `<br><span style="color:#ff445b;">You must unlock <b>${loc.requires.charAt(0).toUpperCase()+loc.requires.slice(1)}</b> first!</span>`;
          } else if (loc.riddle && !inventory[loc.event]) {
            html += `<br><i>Riddle:</i> ${loc.riddle}<br>`;
            html += `<button style="margin-top:5px;padding:4px 12px;border-radius:6px;background:#ffe14b;color:#1e2f3a;" onclick="solveMystery('${loc.answer}','${loc.event}','${loc.name}')">Answer</button>`;
          } else if (!inventory[loc.event]) {
            html += `<br><button style="margin-top:8px;padding:7px 18px;border-radius:8px;background:#ffe14b;color:#1e2f3a;"
                onclick="collectMystical('${loc.event}','${loc.name}')">Collect</button>`;
          } else if (inventory[loc.event]) {
            html += `<br><span style="color:#39ff14;">Mystery unlocked!</span>`;
            if (loc.event === "treasure") html += `<br><b style="color:#fff;font-size:1.22em;">You found the Cosmic Treasure!</b>`;
          }
          showPopup(html,loc.x,loc.y);
        }
      });
      if (!found) popup.style.display="none";
    });

    // --- Collect Mystical Item ---
    function collectMystical(event, name) {
      inventory[event] = true;
      drawMap();
      popup.innerHTML += `<br><span style="color:#39ff14;">${name} unlocked!</span>`;
    }

    // --- Solve Riddle / Mystery ---
    window.solveMystery = function(answer,event,name) {
      let user = prompt("Type your answer:");
      if (!user) return;
      if (user.trim().toLowerCase() === answer) {
        popup.innerHTML += `<br><span style="color:#39ff14;">Riddle solved! ${name} unlocked.</span>`;
        inventory[event] = true;
        drawMap();
      } else {
        popup.innerHTML += `<br><span style="color:#ff445b;">Incorrect! Try again.</span>`;
      }
    }

    // --- Reset Map ---
    function resetMap() {
      inventory = {};
      drawMap();
      popup.style.display = "none";
    }
  </script>
</body>
</html>
