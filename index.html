<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Permissions-Policy" content="microphone=(self)">
    <title>GAVINNOT | Eternal Pirate King</title>
    <style>
        :root { --neon: #00ffff; --pink: #ff00ff; --gold: #fdbc4b; }
        body { background: #000; color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; padding-bottom: 100px; overflow-x: hidden; cursor: none; }

        /* NEON CURSOR TRAIL */
        .cursor-particle {
            position: fixed; top: 0; left: 0; width: 8px; height: 8px;
            background: var(--neon); border-radius: 50%; pointer-events: none;
            z-index: 9999; box-shadow: 0 0 10px var(--neon), 0 0 20px var(--neon);
            animation: particleFade 0.8s forwards;
        }
        @keyframes particleFade { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(0); opacity: 0; } }

        /* SOUND TOGGLE */
        #audio-control { position: fixed; bottom: 20px; left: 20px; z-index: 1000; background: rgba(0,255,255,0.1); border: 1px solid var(--neon); color: var(--neon); padding: 10px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; gap: 10px; font-size: 0.8rem; }

        /* HERO SECTION */
        .hero { position: relative; height: 55vh; display: flex; align-items: center; justify-content: center; overflow: hidden; border-bottom: 2px solid var(--neon); }
        #bg-video { position: absolute; top: 50%; left: 50%; min-width: 100%; min-height: 100%; z-index: -1; transform: translate(-50%, -50%); filter: brightness(0.4); }
        h1 { font-size: clamp(3rem, 10vw, 6rem); color: var(--neon); text-shadow: 0 0 20px var(--neon); margin: 0; letter-spacing: 5px; }

        /* BUTTONS */
        .call-btn { 
            background: rgba(0, 255, 255, 0.1); color: var(--neon); border: 2px solid var(--neon); 
            padding: 15px 40px; font-size: 1.2rem; font-weight: bold; cursor: pointer; border-radius: 50px; 
            margin-top: 20px; transition: 0.3s; text-transform: uppercase; display: inline-flex; align-items: center; gap: 15px; animation: pulse-glow 2s infinite; 
        }
        @keyframes pulse-glow { 0% { box-shadow: 0 0 10px var(--neon); } 50% { box-shadow: 0 0 30px var(--neon); transform: scale(1.02); } 100% { box-shadow: 0 0 10px var(--neon); } }

        /* GALLERY & POLAROIDS */
        .gallery-container { max-width: 1200px; margin: 20px auto; display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 25px; padding: 20px; }
        .polaroid { background: #fff; padding: 10px 10px 30px 10px; box-shadow: 0 10px 25px rgba(0,0,0,0.7); transition: 0.3s; cursor: pointer; transform: rotate(var(--r)); position: relative; overflow: hidden; }
        
        /* DIGITAL GLITCH EFFECT */
        .polaroid:hover { transform: rotate(0deg) scale(1.1); z-index: 10; box-shadow: 0 0 25px var(--neon); }
        .polaroid:hover img { animation: glitch 0.3s infinite; filter: hue-rotate(90deg); }
        
        @keyframes glitch {
            0% { clip-path: inset(10% 0 30% 0); transform: translate(-5px, 2px); }
            20% { clip-path: inset(20% 0 10% 0); transform: translate(5px, -2px); }
            40% { clip-path: inset(40% 0 50% 0); transform: translate(-2px, 5px); }
            60% { clip-path: inset(80% 0 5% 0); transform: translate(2px, -5px); }
            80% { clip-path: inset(10% 0 70% 0); transform: translate(-5px, 2px); }
            100% { clip-path: inset(0); transform: translate(0); }
        }

        .polaroid img { width: 100%; height: 180px; object-fit: cover; transition: 0.2s; }
        .polaroid span { color: #333; font-family: 'Brush Script MT', cursive; font-size: 1.1rem; display: block; text-align: center; margin-top: 8px; }

        /* MERLIN GLOW */
        .polaroid.magic-item { border: 2px solid var(--gold); animation: merlin-pulse 3s infinite ease-in-out; }
        .polaroid.magic-item:hover img { animation: glitch-gold 0.3s infinite; filter: sepia(1) saturate(5) hue-rotate(-30deg); }
        @keyframes glitch-gold { 0% { transform: translate(-2px, 1px); } 100% { transform: translate(2px, -1px); } }

        /* LIGHTBOX & WISH BOX */
        #lightbox { display: none; position: fixed; z-index: 100; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.98); align-items: center; justify-content: center; flex-direction: column; padding: 20px; }
        #lightbox img { max-width: 80%; max-height: 55%; border: 8px solid #fff; margin-bottom: 15px; }
        #story-text { color: #fff; max-width: 600px; text-align: center; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 10px; border-top: 1px solid var(--neon); }
        #wishBox { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(10, 10, 30, 0.95); padding: 30px; border: 2px solid var(--gold); box-shadow: 0 0 30px var(--gold); z-index: 1000; text-align: center; border-radius: 15px; width: 300px; }
        .wish-input { background: #000; border: 1px solid var(--gold); color: var(--gold); padding: 10px; width: 90%; margin-bottom: 15px; outline: none; }
        .spark { position: fixed; color: var(--gold); text-shadow: 0 0 10px var(--gold); pointer-events: none; z-index: 999; animation: floatUp 4s forwards; font-size: 1.2rem; }
        @keyframes floatUp { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(-400px); opacity: 0; } }
    </style>
</head>
<body>

    <audio id="pirate-ambient" loop>
        <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-8.mp3" type="audio/mpeg">
    </audio>

    <div id="audio-control" onclick="toggleAudio()">
        <span id="speaker-icon">ðŸ”ˆ</span> <span>AMBIENCE: OFF</span>
    </div>

    <div id="wishBox">
        <h3 style="color: var(--gold);">MESSAGE TO MERLIN</h3>
        <input type="text" id="userWish" class="wish-input" placeholder="Type your wish...">
        <button class="call-btn" style="font-size: 0.9rem;" onclick="castWish()">CAST WISH</button>
        <button onclick="document.getElementById('wishBox').style.display='none'" style="background:none; border:none; color:#666; display:block; margin: 10px auto; cursor:pointer;">Cancel</button>
    </div>

    <div id="lightbox" onclick="if(event.target == this) this.style.display='none'">
        <img id="lightbox-img">
        <div id="story-text"></div>
        <a id="downloadLink" class="call-btn" style="font-size: 0.8rem;" download>DOWNLOAD ARCHIVE</a>
    </div>

    <div class="hero">
        <video autoplay muted loop playsinline id="bg-video"><source src="ai-king.mp4" type="video/mp4"></video>
        <div style="z-index: 10; text-align: center;">
            <img src="gavinbot.png" style="width: 140px; border-radius: 50%; border: 4px solid var(--neon);">
            <h1>GAVINNOT</h1>
            <button class="call-btn" onclick="startConversation()">Communicate with Gavinnot</button>
        </div>
    </div>

    <h2 style="text-align: center; color: var(--gold); margin-top: 40px;">THE ETERNAL ARCHIVES</h2>
    <div class="gallery-container" id="mainGallery"></div>

    <elevenlabs-convai agent-id="agent_7201kean8367ejw82a3rc4109p0q"></elevenlabs-convai>
    <script src="https://unpkg.com/@elevenlabs/convai-widget-embed@beta" async type="text/javascript"></script>

    <script>
        // AUDIO TOGGLE LOGIC
        const audio = document.getElementById('pirate-ambient');
        const audioBtn = document.getElementById('audio-control');
        function toggleAudio() {
            if (audio.paused) {
                audio.play();
                audioBtn.innerHTML = 'ðŸ”Š AMBIENCE: ON';
                audioBtn.style.color = 'var(--pink)';
                audioBtn.style.borderColor = 'var(--pink)';
            } else {
                audio.pause();
                audioBtn.innerHTML = 'ðŸ”ˆ AMBIENCE: OFF';
                audioBtn.style.color = 'var(--neon)';
                audioBtn.style.borderColor = 'var(--neon)';
            }
        }

        // CURSOR TRAIL
        document.addEventListener('mousemove', (e) => {
            const p = document.createElement('div');
            p.className = 'cursor-particle';
            p.style.left = e.clientX + 'px'; p.style.top = e.clientY + 'px';
            document.body.appendChild(p);
            setTimeout(() => p.remove(), 800);
        });

        // GALLERY LOGIC
        const imgFiles = [
            { src: "assets-blackcode.png", label: "Black Code", story: "The digital DNA of the empire." },
            { src: "assets-gavinbot.png", label: "Gavinbot Assets", story: "Spare parts and logic cores." },
            { src: "auction-items.png", label: "The Auction", story: "Artifacts from the 'Old World'." },
            { src: "back-garden.png", label: "Back Garden", story: "Gavinnot's private sanctuary." },
            { src: "dream.png", label: "The Dream", story: "A visualization of sub-routines." },
            { src: "edge-of-world.png", label: "World's Edge", story: "The boundary of the simulation." },
            { src: "gavinbot-village.png", label: "Bot Village", story: "A community built on logic." },
            { src: "gavinnot-&-gavinbot.png", label: "The Duo", story: "Creator and Creation side by side." },
            { src: "gavinnot-&-gracenot.png", label: "G & G", story: "A rare meeting of the high-council." },
            { src: "gavinnot-&-young-gracenot.png", label: "Memories", story: "Before the pirate crown was forged." },
            { src: "gavinnot-casino.png", label: "The Casino", story: "Place your bets in Bitcoin." },
            { src: "gavinnot-character-poster.png", label: "The Captain", story: "The Eternal Pirate King." },
            { src: "gavinnot-fish-and-chips.png", label: "Fish & Chips", story: "A taste of the physical world." },
            { src: "gavinnot-pirate-&-gavinbot.png", label: "Pirate Link", story: "Direct neural connection established." },
            { src: "gavinnot-village.png", label: "The Village", story: "The heart of Gavinnot's territory." },
            { src: "karaoke-church.png", label: "Karaoke Church", story: "Singing is the highest form of data transfer." },
            { src: "karaoke-circus.png", label: "Karaoke Circus", story: "High-wire acts and high-note songs." },
            { src: "merlin.png", label: "Merlin", isMagic: true, story: "The Eternal Tree. Grown from source code." },
            { src: "shed-essentials.png", label: "Shed Essentials", story: "Tools for the trade." },
            { src: "ship-head.png", label: "Ship's Head", story: "It sees through firewalls." },
            { src: "super-artificial-intelligence-king.png", label: "Super AI", story: "The ultimate evolution." },
            { src: "the-ship.png", label: "The Galleon", story: "Sailing the fiber-optic currents." },
            { src: "the-tech-workshop.png", label: "The Workshop", story: "Where Gavinbots are forged." },
            { src: "the-village-bar.png", label: "The Pub", story: "The local haunt for data-thieves." },
            { src: "treasure.png", label: "The Loot", story: "Decrypted keys and golden bytes." }
        ];

        const gallery = document.getElementById('mainGallery');
        imgFiles.forEach(img => {
            const div = document.createElement('div');
            div.className = img.isMagic ? 'polaroid magic-item' : 'polaroid';
            div.style.setProperty('--r', (Math.random() * 6 - 3).toFixed(2) + 'deg');
            div.onclick = () => {
                if(img.isMagic) document.getElementById('wishBox').style.display = 'block';
                else {
                    document.getElementById('lightbox-img').src = img.src;
                    document.getElementById('story-text').innerHTML = `<strong>${img.label}</strong><br><br>${img.story}`;
                    document.getElementById('downloadLink').href = img.src;
                    document.getElementById('lightbox').style.display = 'flex';
                }
            };
            div.innerHTML = `<img src="${img.src}" onerror="this.src='https://via.placeholder.com/200?text=Error'"><span>${img.label}</span>`;
            gallery.appendChild(div);
        });

        function castWish() {
            const val = document.getElementById('userWish').value;
            if (val.trim()) {
                const s = document.createElement('div');
                s.className = 'spark'; s.innerHTML = "âœ¦ " + val;
                s.style.left = "50%"; s.style.top = "50%";
                document.body.appendChild(s);
                document.getElementById('wishBox').style.display = 'none';
                document.getElementById('userWish').value = "";
                setTimeout(() => s.remove(), 4000);
            }
        }
        
        function startConversation() {
            const el = document.querySelector('elevenlabs-convai');
            if (el && el.shadowRoot) el.shadowRoot.querySelector('button').click();
        }
    </script>
</body>
</html>
